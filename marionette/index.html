<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Collage Marionette Puppet</title>
<style>
  body { margin:0; background:#0b0e14; overflow:hidden; cursor: crosshair; }
  svg { width:100vw; height:100vh; }
  .string { stroke: rgba(200,200,255,0.5); stroke-width:1.5; }
  .joint { fill: rgba(180,180,255,0.8); }
</style>
</head>
<body>

<svg id="stage" viewBox="0 0 1000 700">
  <!-- Banister -->
  <rect x="0" y="40" width="1000" height="10" fill="#777" />

  <!-- Target Pointer -->
  <circle id="target" cx="500" cy="400" r="8" fill="cornflowerblue" />

  <!-- Puppet -->
  <g id="puppet" transform="translate(500 200)">

    <!-- Strings -->
    <line class="string" x1="0" y1="-150" x2="0" y2="-40" />
    <line class="string" x1="-70" y1="-150" x2="-50" y2="30" />
    <line class="string" x1="70" y1="-150" x2="50" y2="30" />

    <!-- Head -->
    <image href="image.png" x="-35" y="-70" width="70" height="70" />

    <!-- Body -->
    <image href="body.jpg" x="-45" y="0" width="90" height="120" />

    <!-- Left Arm (collage image) -->
    <g id="leftArm" transform="rotate(0 -45 30)">
      <image href="arm2.png" x="-120" y="20" width="80" height="120" />
    </g>

    <!-- Right Arm -->
    <g id="arm.png" transform="rotate(0 45 30)">
      <image href="armR.png" x="40" y="20" width="80" height="120" />
    </g>

    <!-- Left Leg -->
    <g id="leftLeg" transform="rotate(0 -20 120)">
      <image href="leftleg.png" x="-60" y="120" width="60" height="150" />
    </g>

    <!-- Right Leg -->
    <g id="rightLeg" transform="rotate(0 20 120)">
      <image href="rightleg.png" x="0" y="120" width="60" height="150" />
    </g>

  </g>
</svg>

<script>
  const puppet = document.getElementById('puppet');
  const target = document.getElementById('target');
  const stage = document.getElementById('stage');
  const leftLeg = document.getElementById('leftLeg');
  const rightLeg = document.getElementById('rightLeg');

  let puppetX = 500;
  let facing = 0; // 0 = profile, 1 = facing viewer
  let walkPhase = 0;
  let targetX = 500;

  stage.addEventListener('click', e => {
    const pt = stage.createSVGPoint();
    pt.x = e.clientX;
    pt.y = e.clientY;
    const svgP = pt.matrixTransform(stage.getScreenCTM().inverse());
    targetX = svgP.x;
    target.setAttribute('cx', targetX);
  });

  function animate() {
    const dx = targetX - puppetX;

    // occasionally decide to face the viewer
    if (Math.random() < 0.002) facing = facing === 0 ? 1 : 0;

    if (Math.abs(dx) > 2) {
      puppetX += Math.sign(dx) * 1.2;
      walkPhase += 0.15;
    }

    const step = Math.sin(walkPhase) * 25;
    leftLeg.setAttribute('transform', `rotate(${step} -20 120)`);
    rightLeg.setAttribute('transform', `rotate(${-step} 20 120)`);

    const flip = dx < 0 ? -1 : 1;
    const rotateBody = facing ? 0 : 15 * flip;

    puppet.setAttribute(
      'transform',
      `translate(${puppetX} 200) scale(${flip} 1) rotate(${rotateBody})`
    );

    requestAnimationFrame(animate);
  }

  animate();
</script>

</body>
</html>

